(()=>{"use strict";var e,t,n,o,r,a,c,i=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(o,")")},l=Object.freeze({gain:.5,numSamples:256}),u=(new Uint8Array(l.numSamples/2),function(e){return t.src=e});function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,r=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==s(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===s(r)?r:String(r)),o)}var r}var h,d,g,m,v,y,p,w=function(){function e(t,n,o,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.assign(this,{centerX:t,centerY:n,divergence:o,c:r,lifetime:a}),this.speed=1,this.petalSize=2}var t,n;return t=e,n=[{key:"dtr",value:function(e){return e*(Math.PI/180)}},{key:"drawCircle",value:function(e,t,n,o,r){e.save(),e.fillStyle=r,e.beginPath(),e.arc(t,n,o,0,2*Math.PI),e.closePath(),e.fill(),e.restore()}},{key:"draw",value:function(e){for(var t=0;t<this.lifetime;t++){var n=t*this.dtr(this.divergence),o=this.c*Math.sqrt(t),r=o*Math.cos(n)+this.centerX,a=o*Math.sin(n)+this.centerY,c=t*this.divergence%361,i="hsl(".concat(c,",100%,50%)");this.drawCircle(e,r,a,this.petalSize,i),this.divergence+=2,this.c+=5e-4,this.petalSize+=.005}}}],n&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),b=[],S=document.querySelector("canvas"),q={showBars:!0,showCircles:!0,showWaveform:!1},T=Object.freeze({sound1:"media/New Adventure Theme.mp3"}),k=function(i){var s,f,y;console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat("rgba(".concat((y=function(){return 185*Math.random()+35})(),",").concat(y(),",").concat(y(),",1)"))),document.querySelector("#title").innerHTML=i.title,document.querySelector("#select-track").innerHTML=i.sounds.map((function(e){return'<option value="'.concat(e.file,'">').concat(e.name,"</option>")})).join(""),document.querySelector("#info").innerHTML="<p>".concat(i.info,"</p>"),s=T.sound1,f=window.AudioContext||window.webkitAudioContext,e=new f,t=new Audio,u(s),n=e.createMediaElementSource(t),(o=e.createAnalyser()).fftSize=l.numSamples,(r=e.createGain()).gain.value=l.gain,(a=e.createBiquadFilter()).type="highshelf",a.frequency.setValueAtTime(1e3,e.currentTime),(c=e.createBiquadFilter()).type="lowshelf",c.frequency.setValueAtTime(1e3,e.currentTime),n.connect(a),a.connect(c),c.connect(o),o.connect(r),r.connect(e.destination),P(S),function(e,t){h=e.getContext("2d"),d=e.width,g=e.height,m=t,v=new Uint8Array(m.fftSize/2),b.push(new w(200,200,137.4,2,v.length/2)),b.push(new w(450,200,137.1,1,v.length/2))}(S,o),M()},P=function(n){var o=document.querySelector("#btn-fs"),i=document.querySelector("#btn-play"),l=document.querySelector("#slider-volume"),s=document.querySelector("#label-volume"),f=document.querySelector("#select-track"),d=document.querySelector("#select-form"),g=document.querySelector("#cb-bars"),m=document.querySelector("#cb-circles");o.onclick=function(e){var t;console.log("goFullscreen() called"),(t=n).requestFullscreen?t.requestFullscreen():t.mozRequestFullscreen?t.mozRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()},i.onclick=function(n){console.log("audioCtx.state before = ".concat(e.state)),"suspended"==e.state&&e.resume(),console.log("audioCtx.state after = ".concat(e.state)),"no"==n.target.dataset.playing?(t.play(),n.target.dataset.playing="yes"):(t.pause(),n.target.dataset.playing="no")},l.oninput=function(e){var t;t=e.target.value,t=Number(t),r.gain.value=t,s.innerHTML=Math.round(e.target.value/2*100)},l.dispatchEvent(new Event("input")),f.onchange=function(e){u(e.target.value),"yes"==i.dataset.playing&&i.dispatchEvent(new MouseEvent("click"))},d.onchange=function(e){"waveform-data"==e.target.value?q.showWaveform=!0:q.showWaveform=!1},g.onclick=function(e){g.checked?q.showBars=!0:q.showBars=!1},m.onclick=function(e){m.checked?q.showCircles=!0:q.showCircles=!1},document.querySelector("#cb-treble").onchange=function(t){t.target.checked?a.gain.setValueAtTime(25,e.currentTime):a.gain.setValueAtTime(0,e.currentTime)},document.querySelector("#cb-bass").onchange=function(t){t.target.checked?c.gain.setValueAtTime(15,e.currentTime):c.gain.setValueAtTime(0,e.currentTime)},n.onclick=function(e){var t=e.target.getBoundingClientRect();!function(e,t){b.push(new w(e,t,135,1,v.length/2));var n=b.length-1;b[n].draw(h)}(e.clientX-t.x,e.clientY-t.y)}};function M(){setTimeout(M,1e3/60),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=0;e.showWaveform?m.getByteTimeDomainData(v):m.getByteFrequencyData(v),h.save(),h.fillStyle="black",h.globalAlpha=.1,h.fillRect(0,0,d,g),h.restore();for(var n=0;n<v.length;n++)t+=v[n];if(e.showBars){var o=(d-4*v.length-10)/v.length;h.save(),h.fillStyle="rgba(255,255,255,0.50)",h.strokeStyle="rgba(0,0,0,0.50)";for(var r=0;r<v.length;r++)h.fillRect(5+r*(o+4),356-v[r],o,200),h.strokeRect(5+r*(o+4),356-v[r],o,200);h.restore()}if(e.showCircles){var a=g/4;h.save(),h.globalAlpha=.5;for(var c=0;c<v.length;c++){var l=v[c]/255,u=l*a;h.beginPath(),h.fillStyle=i(255,111,111,.34-l/3),h.arc(d/2,g/2,u,0,2*Math.PI,!1),h.fill(),h.closePath(),h.beginPath(),h.fillStyle=i(0,0,255,.1-l/10),h.arc(d/2,g/2,1.5*u,0,2*Math.PI,!1),h.fill(),h.closePath(),h.save(),h.beginPath(),h.fillStyle=i(200,200,0,.5-l/5),h.arc(d/2,g/2,.5*u,0,2*Math.PI,!1),h.fill(),h.closePath(),h.restore()}h.restore()}t/=v.length,b.forEach((function(e){e.petalSize=.05+t/70,e.draw(h)}))}(q)}y=k,(p=new XMLHttpRequest).onload=function(e){var t;console.log("In onload - HTTP Status Code = ".concat(e.target.status));try{t=JSON.parse(e.target.responseText)}catch(e){return void(document.querySelector("#output").innerHTML="JSON.parse() failed!")}y(t)},p.onerror=function(e){return console.log("In onerror - HTTP Status Code = ".concat(e.target.status))},p.open("GET","data/av-data.json"),p.send(),window.onload=function(){console.log("window.onload called"),k()}})();