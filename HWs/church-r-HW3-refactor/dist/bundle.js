(()=>{"use strict";var e,t,n,o,a,c,r,i,l=function(e,t,n,o){return void 0===o&&(o=1),"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(o,")")};!function(e){e[e.gain=.5]="gain",e[e.numSamples=256]="numSamples"}(e||(e={}));var s=function(e){return n.src=e},u=function(){function e(e,t,n,o,a){void 0===a&&(a=100),Object.assign(this,{centerX:e,centerY:t,divergence:n,c:o,lifetime:a}),this.speed=1,this.petalSize=2}return e.prototype.dtr=function(e){return e*(Math.PI/180)},e.prototype.drawCircle=function(e,t,n,o,a){e.save(),e.fillStyle=a,e.beginPath(),e.arc(t,n,o,0,2*Math.PI),e.closePath(),e.fill(),e.restore()},e.prototype.draw=function(e){for(var t=0;t<this.lifetime;t++){var n=t*this.dtr(this.divergence),o=this.c*Math.sqrt(t),a=o*Math.cos(n)+this.centerX,c=o*Math.sin(n)+this.centerY,r=t*this.divergence%361,i="hsl(".concat(r,",100%,50%)");this.drawCircle(e,a,c,this.petalSize,i),this.divergence+=2,this.c+=5e-4,this.petalSize+=.005}},e}();const h=u;var d,f,g,m,v,p,y=[];!function(e){e.sound1="media/New Adventure Theme.mp3"}(p||(p={}));var S,w,b=document.querySelector("canvas"),T={showBars:!0,showCircles:!0,showWaveform:!1};function q(){setTimeout(q,1e3/60),function(e){var t=0;e.showWaveform?m.getByteTimeDomainData(v):m.getByteFrequencyData(v),d.save(),d.fillStyle="black",d.globalAlpha=.1,d.fillRect(0,0,f,g),d.restore();for(var n=0;n<v.length;n++)t+=v[n];if(e.showBars){var o=(f-4*v.length-10)/v.length;for(d.save(),d.fillStyle="rgba(255,255,255,0.50)",d.strokeStyle="rgba(0,0,0,0.50)",n=0;n<v.length;n++)d.fillRect(5+n*(o+4),356-v[n],o,200),d.strokeRect(5+n*(o+4),356-v[n],o,200);d.restore()}if(e.showCircles){var a=g/4;for(d.save(),d.globalAlpha=.5,n=0;n<v.length;n++){var c=v[n]/255,r=c*a;d.beginPath(),d.fillStyle=l(255,111,111,.34-c/3),d.arc(f/2,g/2,r,0,2*Math.PI,!1),d.fill(),d.closePath(),d.beginPath(),d.fillStyle=l(0,0,255,.1-c/10),d.arc(f/2,g/2,1.5*r,0,2*Math.PI,!1),d.fill(),d.closePath(),d.save(),d.beginPath(),d.fillStyle=l(200,200,0,.5-c/5),d.arc(f/2,g/2,.5*r,0,2*Math.PI,!1),d.fill(),d.closePath(),d.restore()}d.restore()}t/=v.length,y.forEach((function(e){e.petalSize=.05+t/70,e.draw(d)}))}(T)}S=function(l){var u,S,w;console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat("rgba(".concat((w=function(){return 185*Math.random()+35})(),",").concat(w(),",").concat(w(),",1)"))),document.querySelector("#title").innerHTML=l.title,document.querySelector("#select-track").innerHTML=l.sounds.map((function(e){return'<option value="'.concat(e.file,'">').concat(e.name,"</option>")})).join(""),u=p.sound1,S=window.AudioContext,t=new S,n=new Audio,s(u),o=t.createMediaElementSource(n),(a=t.createAnalyser()).fftSize=e.numSamples,(c=t.createGain()).gain.value=e.gain,(r=t.createBiquadFilter()).type="highshelf",r.frequency.setValueAtTime(1e3,t.currentTime),(i=t.createBiquadFilter()).type="lowshelf",i.frequency.setValueAtTime(1e3,t.currentTime),o.connect(r),r.connect(i),i.connect(a),a.connect(c),c.connect(t.destination),function(e){var o=document.querySelector("#btn-fs"),a=document.querySelector("#btn-play"),l=document.querySelector("#slider-volume"),u=document.querySelector("#label-volume"),f=document.querySelector("#select-track"),g=document.querySelector("#select-form"),m=document.querySelector("#cb-bars"),p=document.querySelector("#cb-circles"),S=document.querySelector("#cb-treble"),w=document.querySelector("#cb-bass");o.onclick=function(t){console.log("goFullscreen() called"),e.requestFullscreen()},a.onclick=function(e){var o=e.target;console.log("audioCtx.state before = ".concat(t.state)),"suspended"==t.state&&t.resume(),console.log("audioCtx.state after = ".concat(t.state)),"no"==o.dataset.playing?(n.play(),o.dataset.playing="yes"):(n.pause(),o.dataset.playing="no")},l.oninput=function(e){var t,n=e.target;t=Number(n.value),t=Number(t),c.gain.value=t,u.innerHTML=String(Math.round(Number(n.value)/2*100))},l.dispatchEvent(new Event("input")),f.onchange=function(e){var t=e.target;s(t.value),"yes"==a.dataset.playing&&a.dispatchEvent(new MouseEvent("click"))},g.onchange=function(e){"waveform-data"==e.target.value?T.showWaveform=!0:T.showWaveform=!1},m.onclick=function(){m.checked?T.showBars=!0:T.showBars=!1},p.onclick=function(){p.checked?T.showCircles=!0:T.showCircles=!1},S.onchange=function(e){e.target.checked?r.gain.setValueAtTime(25,t.currentTime):r.gain.setValueAtTime(0,t.currentTime)},w.onchange=function(e){e.target.checked?i.gain.setValueAtTime(15,t.currentTime):i.gain.setValueAtTime(0,t.currentTime)},e.onclick=function(e){var t=e.target.getBoundingClientRect();!function(e,t){y.push(new h(e,t,135,1,v.length/2));var n=y.length-1;y[n].draw(d)}(e.clientX-t.x,e.clientY-t.y)}}(b),function(e,t){d=e.getContext("2d"),f=e.width,g=e.height,m=t,v=new Uint8Array(m.fftSize/2),y.push(new h(200,200,137.4,2,v.length/2)),y.push(new h(450,200,137.1,1,v.length/2))}(b,a),q()},(w=new XMLHttpRequest).onload=function(e){var t,n=e.target;console.log("In onload - HTTP Status Code = ".concat(n.status));try{t=JSON.parse(n.responseText)}catch(e){return void(document.querySelector("#output").innerHTML="JSON.parse() failed!")}S(t)},w.onerror=function(e){var t=e.target;console.log("In onerror - HTTP Status Code = ".concat(t.status))},w.open("GET","data/av-data.json"),w.send()})();
//# sourceMappingURL=bundle.js.map